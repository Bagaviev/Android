Суть - самое сложное, что приходилось встречать. При одном взгляде на условия, становилось плохо
Сделал 1,5 задачи из 6 кажется. Одна ок, вторая по времени не прошла, но логика правильная.
Не прошел, потрачено.

https://github.com/Bagaviev/Java/tree/master/IDEA_projects/YandexContest